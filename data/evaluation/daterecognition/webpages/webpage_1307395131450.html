<HTML>
<HEAD>
<!--Header Area-->
<TITLE>Sample Chapter from Programming Microsoft速 Access Version 2002 (Core Reference) by Rick Dobson</TITLE>
<META name="description" content="">
<META name="keywords" content="Programming Microsoft速 Access Version 2002 (Core Reference), Rick Dobson, Access, DV-MPE Reference, Aug  1 2001 , Microsoft Press, Computer books, software, learning, training">
<META name="ms.locale" content="en-us">
<META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../css/main.css"  type="text/css">

<!--End Header Area-->
<!-- Start: ToolBar V3.0-->



  <link href="/library/toolbar/3.0/css.aspx?c=/mspress/global/shell.config" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="/mspress/global/css/main3.css"  type="text/css"> 

</head>
<body bgcolor="#ffffff" topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" text="#000000" alink="#660033" link="#003399" vlink="#6699cc"><a name="top"></a>

  <!--TOOLBAR_EXEMPT-->
  <script language="JavaScript" src="/library/toolbar/3.0/?c=/mspress/global/shell.config"></script>
  <noscript>
  <a href="http://www.microsoft.com/windows">
  <img src="/library/toolbar/3.0/noscript.aspx?type=banner&brand=Windows&dir=ltr" border="0" alt="Windows" title="" align="absmiddle" /></a>
  <a href="http://www.microsoft.com/">Microsoft.com Home</a> |   
  <a href="/library/toolbar/3.0/sitemap.aspx?locale=en-us">Site Map</a> |   
  <a href="http://search.microsoft.com/search/search.aspx?View=en-us">Search</a>
  </noscript>

<!-- End: ToolBar V3.0-->
<!-- End: ToolBar V3.0-->

<!-- Flyout ClickTrax 1.5 script starts here -->
<script language="JavaScript" src="/library/include/ctredir.js"></script>
<!-- Flyout ClickTrax 1.5 script ends -->
<!--  OVERALL TABLE  -->
<table cellpadding="0" cellspacing="0" border="0" width="100%">
	<tr>	
		<td valign="top" rowspan="3" id="leftnav" menudata="/mspress/global/menu.xml" style="background-color:#f1f1f1;border-right:1pt solid #999999">
<!--  LEFT NAV  -->					
			
			<table class="flyoutmenu" width="180" menudata="/mspress/global/menu.xml">
				<tr>
					<td>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutHeading"><img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" />Training</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S1_Node1" LinkArea="Flyout" href="http://www.microsoft.com/Learning/training/find/FindCourse.mspx">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Find Training </a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S1_Node2" LinkArea="Flyout" href="http://learning.microsoft.com/Manager/default.aspx?brand=Learning">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Manage My Learning</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="training">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S1_Node3" LinkArea="Flyout" href="http://www.microsoft.com/learning/training/">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Training Options</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="subject">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Browse by Subject</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="plans">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Guide My Training</a>
								</td>
							</tr>
						</table>
					</td>
				</tr>				
			</table>
			<table class="flyoutmenu" width="180" menudata="/mspress/global/menu.xml">
				<tr>
					<td>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutHeading">
									<img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" />Certifications
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink"><a onclick="javascript:trackInfo(this);" LinkID="Flyout_S2_Node1" LinkArea="Flyout" href="http://www.microsoft.com/learning/mcp/">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Certification Overview</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="certsubject">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Browse by Subject</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="certname">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Browse by Name</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S2_Node2" LinkArea="Flyout" href="http://www.microsoft.com/learning/mcpexams/prepare/findexam.mspx">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Find an Exam</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S2_Node3" LinkArea="Flyout" href="http://www.microsoft.com/learning/mcpexams/prepare/">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Prepare for an Exam</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S2_Node4" LinkArea="Flyout" href="http://www.microsoft.com/learning/mcpexams/register/">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Register for an Exam</a>
								</td>
							</tr>
						</table>
					</td>
				</tr>				
			</table>
			<table class="flyoutmenu" width="180" menudata="/mspress/global/menu.xml">
				<tr>
					<td>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutHeading"><img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Books</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S3_Node1" LinkArea="Flyout" href="http://www.microsoft.com/learning/books/">
									<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Books Overview</a>
								</td>
							</tr>
						</table>
					<table width="100%" cellpadding="0" cellspacing="0" border="0">
						<tr>
							<td class="flyoutLink">
								<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S3_Node2" LinkArea="Flyout" href="http://www.microsoft.com/mspress/hop/">
								<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />New and Upcoming</a>
							</td>
						</tr>
					</table>
					<table width="100%" cellpadding="0" cellspacing="0" border="0">
						<tr>
							<td class="flyoutLink" handle="books">
								<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Find Books</a>
							</td>
						</tr>
					</table>
					<table width="100%" cellpadding="0" cellspacing="0" border="0">
						<tr>
							<td class="flyoutLink">
								<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S3_Node3" LinkArea="Flyout" href="http://www.microsoft.com/learning/books/howtobuy/buy.mspx">
								<img src="/mspress/images/1pxt.gif" width="7" height="1" border="0" />Where to Buy</a>
							</td>
						</tr>
					</table>
					
					</td>
				</tr>				
			</table>
			<table class="flyoutmenu" width="180" menudata="/mspress/global/menu.xml">
				<tr>
					<td>
					<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutHeading"><img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" />Special Offers</td>
							</tr>
						</table>						
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
   <tr><td class="flyoutLink"><a onclick="javascript:trackInfo(this);" LinkID="Flyout_S4_Node1" LinkArea="Flyout" href="http://www.microsoft.com/learning/offers/">
   <img src="/mspress/images/1pxt.gif" width="2" height="1" border="0" />What's New</a></td></tr></table>											
					</td>
				</tr>				
			</table>
			<table class="flyoutmenu" width="180" menudata="/mspress/global/menu.xml">
				<tr>
					<td>
					<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutHeading"><img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" />Community</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S5_Node1" LinkArea="Flyout" href="http://www.microsoft.com/learning/community/">
									<img src="/mspress/images/1pxt.gif" width="2" height="1" border="0" />Learning Community</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink" handle="member">
									<img src="/mspress/images/1pxt.gif" width="2" height="1" border="0" />Member Sites</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S5_Node2" LinkArea="Flyout" href="http://www.microsoft.com/learning/worldwide/">
									<img src="/mspress/images/1pxt.gif" width="2" height="1" border="0" />Worldwide Sites</a>
								</td>
							</tr>
						</table>
						<table width="100%" cellpadding="0" cellspacing="0" border="0">
							<tr>
								<td class="flyoutLink">
									<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S5_Node3" LinkArea="Flyout" href="http://www.microsoft.com/learning/support/">
									<img src="/mspress/images/1pxt.gif" width="2" height="1" border="0" />Help and Support</a>
								</td>
							</tr>
						</table>
					</td>
				</tr>				
			</table>			
			
			<table>
				<tr>
					<td>
						<table width="100%" cellpadding="0" cellspacing="10" border="0">
							<tr>
								<td class="flyoutHeading">
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
			
			<table width="100%" cellpadding="0" cellspacing="0" border="0">
				<tr>
					<td>
						<img src="/mspress/images/1pxt.gif" width="10" height="1" border="0" />
						<!--script language="JavaScript">
						<!-- Hide this script from old browsers --
						document.write('<a onclick="javascript:trackInfo(this);" LinkID="Flyout_S6_Node1" LinkArea="Flyout" href="' + link + '"><IMG SRC="' + image + '" alt="' + alt +'" border="0"></a>')
						// -- End Hiding Here -->
						<!--</script>-->
						<br /><br /><br />
					</td>
				</tr>
			</table>
		</td>
<!--END LEFT NAV-->
<!--PIXEL LINE-->		
		<td rowspan="3" valign="top"><img src="/mspress/images/1pxt.gif" width="15" height="1" border="0" /></td>
		<td align="left" valign="top" width="100%"><img src="/mspress/images/1pxt.gif" width="1" height="20" border="0" />
<!--StartMainInc-->
<img src="/mspress/images/1pxt.gif" width="1" height="10" border="0" /><br />
<a name="top"></a>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
&nbsp;<tr>
<td colspan="2">
<img src="/mspress/images/1pxt.gif" width="538" height="1" border="0" /></td>
</tr>
</tr>
<!--Now we render the top portion, with general book info etc..., and the right nav-->
<tr>
<td valign="top" colspan="2">
<font face="Verdana,Arial,Helvetica" size="3" color="#003366">
<b>
Programming Microsoft速 Access Version 2002 (Core Reference)
</b>
</font>
</td>
</tr>
</table>
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td valign="top" align="left" width="100%">
<img src="/mspress/images/1pxt.gif" width="1" height="2" border="0" />
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr>
<td valign="top" rowspan="9" width="130">
<a href="
										/mspress/books/5241.aspx
									">
<img alt="" border="0" height="130" width="130" src="
											/MSPress/books/imgt/5241.gif
										" alt="Programming Microsoft速 Access Version 2002 (Core Reference)" />
</a></td>
<td valign="top" rowspan="9" width="5">
<img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" /></td>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">Author</font></td>
<td valign="top" rowspan="9" width="5">
<img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" /></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
Rick Dobson
</font></td>
<td valign="top" rowspan="9" width="5">
<img src="/mspress/images/1pxt.gif" width="5" height="1" border="0" /></td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">Pages</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
1152
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">Disk</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
1 Companion CD(s)
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">Level</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
All Levels
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">Published</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
08/01/2001
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">ISBN</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
9780735614055
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<font face="Verdana,Arial,Helvetica" size="1">ISBN-10</font></td>
<td valign="top" align="left" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
0-7356-1405-9
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="13%">
<font face="Verdana,Arial,Helvetica" size="1">Price(USD)</font></td>
<td valign="top" align="left" width="50%">
<font face="Verdana,Arial,Helvetica" size="1">
<strike style="color:red">
												$59.99
</strike>
<br />
<font color="#ff3300">To see this book's discounted price, select a reseller below.</font>
</font>
</td>
</tr>
<tr>
<td valign="top" align="left" width="65">
<img src="/mspress/images/1pxt.gif" width="1" height="1" border="0" />
</td>
<td valign="top" align="left" width="100%">
<img src="/mspress/images/1pxt.gif" width="162" height="1" border="0" />
</td>
</tr>
</table>
</td>
<td valign="top" align="right" width="162">
<img src="/mspress/images/1pxt.gif" width="1" height="2" border="0" />
<table border="0" cellspacing="0" cellpadding="0" width="150" align="right">
<tr>
<td colspan="4">
<INPUT type="button" name="AddtoMyLearning" value="Add to My Learning" onclick="window.location = 'http://learning.microsoft.com/manager/AddToMyLearning.aspx?resourceId=';" />
</td>
</tr>
<tr>
<td colspan="4">&nbsp;</td>
</tr>
<tr><td valign="top" class="rhNavHead" bgcolor="#0099ff" height="20" colspan="4">
<img src="/mspress/images/1pxt.gif" width="5" height="3" /><br />
<img src="/mspress/images/1pxt.gif" width="5" height="1" />
<b>More Information</b>
<img src="/mspress/images/1pxt.gif" width="5" height="3" />
</td></tr>
<tr>
<td valign="top" bgcolor="#999999" width="1"><img src="/mspress/images/1pxt.gif" width="1" height="1" border="0" /></td>
<td valign="top" width="100%">
<font face="Verdana,Arial,Helvetica" size="1">
<img src="/mspress/images/1pxt.gif" width="1" height="6" border="0" /><br />
<img src="/mspress/images/1pxt.gif" width="1" height="15" border="0" />
<a class="bookmark" href="/MSPress/books/5241.aspx#AboutTheBook">
About the Book
</a><br />
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/mspress/books/toc/5241.aspx#TableOfContents">Table of Contents</a><br>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/mspress/books/sampchap/5241.aspx#SampleChapter">Sample Chapter</a><br>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0">
<a class="bookmark" href="/mspress/books/index/5241.aspx#Index">Index</a><br>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0">
<a class="bookmark" href="/mspress/findabook/list/series_SH.aspx">Related Series</a><br>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/mspress/books/5241.aspx#RelatedBooks">Related Books</a><br />

<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/MSPress/books/authors/auth5241.aspx">

									About the Author</a><br /><p></p>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/mspress/support/">Support: Book & CD</a>
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" /><br />
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<br />
<img src="/mspress/images/1pxt.gif" width="1" height="11" border="0" />
<a class="bookmark" href="/MSPress/books/reviews/default.aspx?id=5241&isbn=9780735614055">

                								Rate this book</a><br />
<img src="/mspress/images/1pxt.gif" width="1" height="8" border="0" />
</font>
</td>
<td valign="top" bgcolor="#999999" width="1"><img src="/mspress/images/1pxt.gif" width="1" height="1" border="0" /></td>
</tr>
<tr>
<td valign="top" bgcolor="#999999" height="1" colspan="4"><img src="/mspress/images/1pwhite.gif" width="1" height="1" border="0" align="right" hspace="0" />
<img src="/mspress/images/1pwhite.gif" width="1" height="1" border="0" /></td>
</tr>
</table>
</td>
<td width="16"><img src="/mspress/images/1pxt.gif" width="16" height="1" border="0" /></td>
</tr>
<tr>
<td valign="top" colspan="3">
<table>
<tr>
<td><a href="http://search.barnesandnoble.com/booksearch/isbnInquiry.asp?isbn=9780735614055"><img border="0" width="112" height="21" alt="Barnes Noble" src="/mspress/images/button_BN.gif"></img></a></td>
<td><a href="http://www.amazon.com/gp/product/0735614059/sr=1-1/qid=1156801743/ref=sr_1_1/104-6313703-3867159?ie=UTF8&s=books"><img border="0" width="112" height="21" alt="Amazon" src="/mspress/images/button_AMZN1.gif"></img></a></td>
<td><a href="http://www.quantumbooks.com/mspress.mvc?id=9780735614055"><img border="0" width="112" height="21" alt="Quantum Books" src="/mspress/images/button_Quantum.gif"></img></a></td>
</tr>
</table>
</td>
</tr>
</table>
<!--EndMainInc-->

<P><FONT size=1>&nbsp;</FONT>

<!--Body Area-->
<a name="SampleChapter"></a><hr size="1" noshade>
<h2 class="chapter">Chapter 2: Data Access Models: Part I&nbsp;<I>continued</I></h2>
<hr size="1" noshade>
<P>
<H3><I><A NAME="124"></A>Seeking Records</I></H3>
The <I>Seek </I>method is another recordset method that can facilitate finding records in a record source. This method is exclusively used for recordsets that specify a table as their source. In addition, you must set the <I>Options</I> parameter for the recordset <I>Open </I>method to <I>adCmdTableDirect</I>, instead of setting it to <I>adCmdTable </I>or leaving it blank. Furthermore, the table serving as a record source must have an index on the field or fields that your application searches to find matches for criterion values. ADO does not offer built-in support for creating dynamic indexes for the <I>Seek</I> method, but your application can programmatically create an index using the ADOX library for Jet and the SQL-DMO library for SQL Server. The <I>Seek </I>method also requires a server-side cursor. Using any value other than <I>adUseServer</I> for a recordset's <I>CursorLocation </I>property disables the method.<P>
<Div class= "sidebar"><B>NOTE</B><HR><BR>
The <I>Seek</I> method is not a core ADO data access feature. ADO providers can optionally offer it. Use the recordset <I>Supports</I> method with <I>adSeek</I> as an argument to return a Boolean indicating whether a provider offers the <I>Seek </I>method. To seek on an index, apply the method to a recordset after opening it.</Div class= "sidebar"><P>
The <I>Seek</I> method searches for a key value or values, and it optionally takes a <I>SeekOption </I>parameter that can guide the operation of the method. If the index for the <I>Seek</I> method has just one column, you can specify only a single criterion value. If the index for a recordset relies on multiple columns, use an<I> Array</I> function to specify values for all the columns in the index. This capability to search concurrently on multiple columns is one feature distinguishing the <I>Seek </I>method from the <I>Find </I>method. The <I>Seek</I> method makes available the recordset in the order of the index and positions the current record at the first record matching the criteria.<P>
You can refine the search behavior of the <I>Seek</I> method with some settings for its<I> SeekOptions</I> parameter using one of the<I> SeekEnum</I> enums. The <I>SeekOptions</I> setting appears immediately after the key value or values for a <I>Seek</I> method. The syntax for the <I>Seek</I> method with both key values and <I>SeekOptions</I> is <I>rst.Seek &lt;Keyvalues&gt;, &lt;SeekOptions&gt;</I>. Table 2-5 lists the <I>SeekEnum </I>members with their values and behavior.<P>
<B>Table 2-5&nbsp;</B><I>Intrinsic Constants for the SeekEnum</I><P>
<TABLE WIDTH=100% BORDER=0 CELLPADDING=4 CELLSPACING=1>
<TR>
<TD BGCOLOR="#999999" VALIGN=TOP><B><B>Constant</B></B></TD><TD BGCOLOR="#999999" VALIGN=TOP><B><B>Value</B></B></TD><TD BGCOLOR="#999999" VALIGN=TOP><B><B>Behavior</B></B></TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekFirstEQ</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP><I> 1</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the first record on the index or indexes matching the key value or values.</TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekLastEQ</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP> <I>2</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the last record on the index or indexes matching the key value or values.</TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekAfterEQ</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP> <I>4</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the first record (or the one after it when no match exists) on the index or indexes matching the key value or values.</TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekAfter</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP> <I>8</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the first record after that potential match to the key value or values on the index or indexes.</TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekBeforeEQ</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>16</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the first record (or the one before it when no match exists) on the index or indexes matching the key value or values.</TD>
</TR>
<TR>
<TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>adSeekBefore</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP><I>32</I></TD><TD BGCOLOR="#CCCCCC" VALIGN=TOP>Seek the first record before a potential match to the key value or values on the index or indexes.</TD>
</TR>
</TABLE><P>

The <I>SeekingUnShippedOrders</I> procedure that follows illustrates three ways to use the <I>Seek</I> method. Before actually invoking the <I>Seek</I> method, your application must properly prepare the recordset. First, assign the <I>Index </I>property so that it contains the values for which you want to search. Second, open the recordset with the <I>adCmdTableDirect </I>setting for the <I>Options</I> parameter. Third, ensure the <I>CursorLocation </I>property has a setting of <I>adUseServer</I>. This is the default setting, so you don't need to assign the property a setting unless your application has changed its default setting. The following procedure demonstrates the first two steps. The third step is not necessary in this sample.<P>
<PRE class="code">Sub&nbsp;SeekingUnshippedOrders()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;recordset;&nbsp;Seek&nbsp;method&nbsp;requires<BR>'index&nbsp;assignment,&nbsp;adCmdTableDirection&nbsp;Open&nbsp;option,&nbsp;and<BR>'adUserServer&nbsp;setting&nbsp;for&nbsp;CursorLoction&nbsp;(default)<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.ActiveConnection&nbsp;=&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<BR>rst1.CursorType&nbsp;=&nbsp;adOpenKeyset<BR>rst1.LockType&nbsp;=&nbsp;adLockOptimistic<BR>rst1.Index&nbsp;=&nbsp;&quot;ShippedDate&quot;<BR>rst1.Open&nbsp;&quot;Orders&quot;,&nbsp;,&nbsp;,&nbsp;,&nbsp;adCmdTableDirect<BR><P>
'Print&nbsp;first&nbsp;order&nbsp;not&nbsp;shipped<BR>rst1.Seek&nbsp;Null,&nbsp;adSeekFirstEQ<BR>Debug.Print&nbsp;rst1(&quot;OrderID&quot;),&nbsp;rst1(&quot;OrderDate&quot;)<P>
'Print&nbsp;last&nbsp;order&nbsp;not&nbsp;shipped<BR>rst1.Seek&nbsp;Null,&nbsp;adSeekLastEQ<BR>Debug.Print&nbsp;rst1(&quot;OrderID&quot;),&nbsp;rst1(&quot;OrderDate&quot;)<P>
'Print&nbsp;all&nbsp;orders&nbsp;not&nbsp;shipped<BR>rst1.Seek&nbsp;Null<BR>Do<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;OrderID&quot;),&nbsp;rst1(&quot;OrderDate&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Loop&nbsp;Until&nbsp;IsNull(rst1(&quot;ShippedDate&quot;))&nbsp;=&nbsp;False<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub</PRE><P>
The first two instances of the <I>Seek</I> method in <I>SeekingUnShippedOrders</I> both demonstrate the syntax for the <I>Keyvalues </I>and <I>SeekOptions</I> parameters. The first instance of the <I>Seek</I> method sets the cursor at the first record in the <I>Orders</I> table that is unshipped. This record has the order ID 11008. The steps for opening the <I>rst1</I> recordset on the <I>Orders</I> table arrange the records in order on the <I>ShippedDate</I> index, so that the special ordering indicated by the <I>Seek </I>method's <I>Keyvalues </I>and <I>SeekOptions</I> parameters will work. The second instance of the <I>Seek </I>method in the <I>SeekingUnShippedOrders </I>procedure sets the cursor at the last <I>Orders </I>table record with a Null value for the <I>ShippedDate </I>field. This record has the order ID 11077. The third instance of the <I>Seek</I> method in the preceding procedure searches for all unshipped orders without specifying a <I>SeekOptions</I> setting. Its following <I>Do</I> loop iterates through the reordered recordset to print the <I>OrderID </I>field and <I>OrderDate</I> field for each record with a Null <I>ShippedDate</I> field value.<P>
The <I>SeekWith2IndexValues</I> procedure demonstrates the syntax for designating a seek for two criterion values: the <I>OrderID </I>and <I>ProductID</I> fields of the primary key for the <I>Order Details</I> table. The procedure also demonstrates how to reuse a <I>Recordset </I>object. In the first use of the <I>rst1 </I>recordset, the procedure searches for all line items matching an <I>OrderID</I> input by the user. The procedure uses an <I>InputBox </I>function nested inside a <I>CInt</I> function to permit a user to input an <I>OrderID </I>field value. It then returns the <I>OrderID </I>and<I> ProductID</I> for the line items associated with that record. This first seek relies on the <I>OrderID</I> index for the <I>Order Details</I> table.<P>
<PRE class="code">Sub&nbsp;SeekWith2IndexValues()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;int1&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int2&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int3&nbsp;As&nbsp;Integer<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;recordset;&nbsp;Seek&nbsp;method&nbsp;requires<BR>'index&nbsp;assignment,&nbsp;adCmdTableDirection&nbsp;Open&nbsp;option,&nbsp;and<BR>'adUserServer&nbsp;setting&nbsp;for&nbsp;CursorLocation&nbsp;(default)<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.ActiveConnection&nbsp;=&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<BR>rst1.CursorType&nbsp;=&nbsp;adOpenKeyset<BR>rst1.LockType&nbsp;=&nbsp;adLockOptimistic<BR>rst1.Index&nbsp;=&nbsp;&quot;OrderID&quot;<BR>rst1.Open&nbsp;&quot;Order&nbsp;Details&quot;,&nbsp;,&nbsp;,&nbsp;,&nbsp;adCmdTableDirect<P>
'Search&nbsp;for&nbsp;a&nbsp;user-specified&nbsp;OrderID;<BR>'save&nbsp;OrderID&nbsp;and&nbsp;ProductID&nbsp;of&nbsp;order's&nbsp;last&nbsp;line&nbsp;item<BR>int1&nbsp;=&nbsp;CInt(InputBox(&quot;Input&nbsp;OrderID:&nbsp;&quot;))<BR>rst1.Seek&nbsp;int1<BR>Do&nbsp;Until&nbsp;rst1(&quot;OrderID&quot;)&nbsp;&lt;&gt;&nbsp;int1<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;OrderID&quot;),&nbsp;rst1(&quot;ProductID&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;rst1.EOF&nbsp;Then&nbsp;Exit&nbsp;Do<BR>Loop<BR>rst1.MovePrevious<BR>int2&nbsp;=&nbsp;rst1(&quot;OrderID&quot;)<BR>int3&nbsp;=&nbsp;rst1(&quot;ProductID&quot;)<P>
'Close&nbsp;and&nbsp;reopen&nbsp;Order&nbsp;Details&nbsp;to&nbsp;seek<BR>'last&nbsp;line&nbsp;item&nbsp;in&nbsp;the&nbsp;order<BR>rst1.Close<BR>rst1.Index&nbsp;=&nbsp;&quot;PrimaryKey&quot;<BR>rst1.Open&nbsp;&quot;Order&nbsp;Details&quot;,&nbsp;,&nbsp;,&nbsp;,&nbsp;adCmdTableDirect<P>
rst1.Seek&nbsp;Array(int2,&nbsp;int3)<BR>Debug.Print&nbsp;rst1(&quot;OrderID&quot;),&nbsp;rst1(&quot;ProductID&quot;),&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;FormatCurrency(rst1(&quot;UnitPrice&quot;)),&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Quantity&quot;),&nbsp;FormatPercent(rst1(&quot;Discount&quot;),&nbsp;0)<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub</PRE><P>
The second instance of the <I>Seek </I>method in the <I>SeekWith2IndexValues</I> procedure seeks the last item for the <I>OrderID</I> that a user input. At the conclusion of the first <I>Seek </I>instance, the procedure saves the <I>OrderID </I>and <I>ProductID</I> field values for the last line item in the order a user referenced. Then the procedure closes the recordset to assign a new index. The index is the primary key that relies on both <I>OrderID </I>and <I>ProductID</I>. Next the procedure reopens the recordset. The new index is critical for permitting the use of a compound criterion that includes values for both the <I>OrderID </I>and <I>ProductID</I> field values. Notice the use of the <I>Array</I> function for indicating more than one key value. The cursor points to the record in the recordset for the line item sought. The procedure prints it while formatting the <I>UnitPrice </I>and<I> Discount</I> columns.<P>
<H3><I><A NAME="126"></A>Filtering Records</I></H3>
The <I>Find </I>method can go through a recordset sequentially and disclose matches one at a time. The method does not create another version of the recordset that contains all the records that match the criterion values. When you need a new or alternate recordset containing just the matches, your application needs a different approach. The <I>Seek</I> method offers a partial solution to this <I>Find</I> method deficiency, but the <I>Seek </I>method has special requirements that restrict its applicability, such as the need for an index. In addition, the <I>Seek </I>method does not truly exclude nonmatching records. It merely positions the current record at the first matching record.<P>
The recordset <I>Filter </I>property offers a second solution to the <I>Find </I>method's inability to return a subset of a recordset based on one or more fields. This property lets you designate a simple criterion for a field, and it returns a filtered version of the original recordset with only those records that match the criterion value or values. By setting the <I>Filter </I>property to any of a series of constants instead of to a criterion string, you can achieve special effects for database replication or for updating a remote data source. One filter constant, <I>adFilterNone</I>, removes the filter setting from a recordset and restores the original rowset. The <I>Filter</I> property also resolves another shortcoming of the <I>Find</I> method: it can select records based on more than one field value. Furthermore, it does not require an index to accomplish this goal, as does the <I>Seek </I>method.<P>
The following two procedures filter a recordset based on the <I>Customers</I> table in the Northwind database. The <I>FilterRecordset </I>procedure manages the overall use of the <I>Filter </I>property, prints the results set, clears the filter, and then prints the results set again. The <I>FilterRecordset </I>procedure relies on the <I>FilterLikeField </I>function. This custom function manages the setting of the <I>Filter </I>property based on parameters passed to it by the <I>FilterRecordset </I>procedure, and it returns the filtered recordset.<P>
<PRE class="code">Sub&nbsp;FilterRecordset()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;recordset<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.ActiveConnection&nbsp;=&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<BR>rst1.Open&nbsp;&quot;Customers&quot;,&nbsp;,&nbsp;,&nbsp;,&nbsp;adCmdTable<P>
'Filter&nbsp;recordset,&nbsp;and&nbsp;print&nbsp;filtered&nbsp;result<BR>Set&nbsp;rst1&nbsp;=&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;FilterLikeField(rst1,&nbsp;&quot;CustomerID&quot;,&nbsp;&quot;D*&quot;)<BR>Debug.Print&nbsp;rst1.GetString<P>
'Restore&nbsp;recordset,&nbsp;and&nbsp;print&nbsp;restored&nbsp;result<BR>rst1.Filter&nbsp;=&nbsp;adFilterNone<BR>Debug.Print&nbsp;rst1.GetString<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub<P>
Function&nbsp;FilterLikeField(rst1&nbsp;As&nbsp;ADODB.Recordset,&nbsp;_<BR>strField&nbsp;As&nbsp;String,&nbsp;strFilter&nbsp;As&nbsp;String)&nbsp;As&nbsp;ADODB.Recordset<P>
'Set&nbsp;a&nbsp;filter&nbsp;on&nbsp;the&nbsp;specified&nbsp;Recordset&nbsp;object,&nbsp;and&nbsp;then<BR>'return&nbsp;the&nbsp;filtered&nbsp;recordset<BR>rst1.Filter&nbsp;=&nbsp;strField&nbsp;&amp;&nbsp;&quot;&nbsp;LIKE&nbsp;'&quot;&nbsp;&amp;&nbsp;strFilter&nbsp;&amp;&nbsp;&quot;'&quot;<BR>Set&nbsp;FilterLikeField&nbsp;=&nbsp;rst1<P>
End&nbsp;Function</PRE><P>
The <I>FilterRecordset</I> procedure starts by creating and opening the <I>rst1 </I>recordset. Next it applies a filter by calling the <I>FilterLikeField </I>function, which takes three arguments and returns a filtered recordset based on them. <I>FilterRecordset</I> assigns the filtered return set to <I>rst1</I> and prints the filtered recordset<I> </I>to confirm the result.<P>
The arguments to <I>FilterLikeField </I>include <I>rst1</I>, a field name on which to filter records, and a filter criterion value, which can include any legitimate expression for the Like<I> </I>operator used by <I>FilterLikeField</I>. <I>FilterRecordset</I> passes <I>D*</I> to find just the records that have a <I>CustomerID </I>beginning with the letter <I>D</I>. The <I>Filter </I>property does not restrict you to filtering with the LIKE<I> </I>operator. Other acceptable operators include &lt;, &gt;, &lt;=, &gt;=, &lt;&gt;, and =. You can also include AND<I> </I>and OR<I> </I>operators in your criteria expressions to combine two or more criteria expressions based on the other legitimate operators.<P>
The <I>Filter </I>property restricts your criteria expressions to those of the form &lt;<I>FieldName&gt; &lt;Operator&gt; &lt;Value&gt;</I>. However, some <I>Filter </I>intrinsic constants that are members of the <I>FilterGroupEnum</I> enumenable special uses of the property. The <I>FilterRecordset </I>procedure uses the <I>adFilterNone </I>constant to restore a recordset by removing its filters. You can also use other <I>FilterGroupEnum</I> enum members to resolve conflicts associated with performing a batch update against a remote data source.<P>
The sample demonstrating compound filters uses two procedures. The first procedure, <I>CallFilterOnCountryAndCity</I>, sets the criteria strings for both country and city, the two filter fields for the <I>Customers </I>table. Then the sample calls <I>FilterOnCountryAndCity</I>, the procedure that applies the filter, and it saves a reference to the filtered recordset. The main procedure concludes by printing selected fields. Before printing field values, however, it uses the <I>FindTheLongest</I> function procedure to determine the longest character for each of two fields.<P>
<PRE class="code">Sub&nbsp;CallFilterOnCountryAndCity()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;strCountry&nbsp;As&nbsp;String<BR>Dim&nbsp;strCity&nbsp;As&nbsp;String<BR>Dim&nbsp;int1&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int2&nbsp;As&nbsp;Integer<P>
'Set&nbsp;Country&nbsp;and&nbsp;City&nbsp;criteria<BR>strCountry&nbsp;=&nbsp;&quot;USA&quot;<BR>strCity&nbsp;=&nbsp;&quot;Portland&quot;<P>
'Call&nbsp;Filter&nbsp;routine,&nbsp;and&nbsp;store&nbsp;reference&nbsp;to<BR>'filtered&nbsp;return&nbsp;set<BR>Set&nbsp;rst1&nbsp;=&nbsp;FilterOnCountryAndCity(strCountry,&nbsp;strCity)<P>
'Get&nbsp;the&nbsp;longest&nbsp;lengths&nbsp;for&nbsp;the<BR>'ContactName&nbsp;and&nbsp;CompanyName&nbsp;fields<BR>int1&nbsp;=&nbsp;FindTheLongest(rst1,&nbsp;&quot;ContactName&quot;)&nbsp;+&nbsp;1<BR>rst1.MoveFirst<BR>int2&nbsp;=&nbsp;FindTheLongest(rst1,&nbsp;&quot;CompanyName&quot;)&nbsp;+&nbsp;1<P>
'Print&nbsp;selected&nbsp;fields&nbsp;from&nbsp;filtered&nbsp;recordset<BR>rst1.MoveFirst<BR>Do&nbsp;Until&nbsp;rst1.EOF<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;ContactName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int1&nbsp;-&nbsp;Len(rst1(&quot;ContactName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst1(&quot;CompanyName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;City&quot;),&nbsp;rst1(&quot;Country&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Loop<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub<P>
Function&nbsp;FilterOnCountryAndCity(strCountry&nbsp;As&nbsp;String,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;strCity&nbsp;As&nbsp;String)&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;recordset<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.ActiveConnection&nbsp;=&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<BR>rst1.Open&nbsp;&quot;Customers&quot;,&nbsp;,&nbsp;adOpenKeyset,&nbsp;adLockOptimistic,&nbsp;adCmdTable<P>
'Set&nbsp;Filter&nbsp;property<BR>rst1.Filter&nbsp;=&nbsp;&quot;Country&nbsp;=&nbsp;'&quot;&nbsp;&amp;&nbsp;strCountry&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;'&nbsp;AND&nbsp;City&nbsp;=&nbsp;'&quot;&nbsp;&amp;&nbsp;strCity&nbsp;&amp;&nbsp;&quot;'&quot;<P>
'Return&nbsp;filtered&nbsp;recordset<BR>Set&nbsp;FilterOnCountryAndCity&nbsp;=&nbsp;rst1<P>
End&nbsp;Function</PRE><P>
<H3><I><A NAME="128"></A>Persisting Recordsets</I></H3>
By using the <I>Save</I> method, you can persist a recordset. Later, with the <I>Open</I> method and the MSPersist provider, you can open a saved recordset. This capability serves a couple of purposes particularly well. First, this capability comes in handy when you need to take a snapshot of a record source for viewing later on a computer that is disconnected from the data source for the records. Second, when remote server access is either slow or unreliable, using a saved recordset based on a record source from a remote server gives an application fast, reliable data access. This is especially convenient for read-only record sources. In either context, you can modify a saved record source and later update the remote source with the <I>UpdateBatch </I>method.<P>
You can persist a recordset's contents with either of two formats, a proprietary format or an XML format. Designate your preferred format with a member of the <I>PersistFormatEnum</I> enum in the statement using the <I>Save</I> method. Saving a file in XML format enables another application to open and view the recordset's data. The <I>Open</I> method, which inserts the file's contents into a recordset, works equally well with either format. For example, you can readily view the saved XML file in the Microsoft Internet Explorer browser shipping with Office XP. Internet Explorer allows you to view the XML tags and data. The proprietary format is not so easy to view natively. However, users can readily open a file in the proprietary format and then examine its contents in the recordset to which the <I>Open </I>method deposits the file's contents.<P>
The following sample opens a recordset on the <I>Shippers</I> table from the Northwind database on the C share of a remote computer named cabarmada. It saves the recordset to a drive on the local computer. The <I>Save</I> method designates an XML file format by using the <I>adPersistXML</I> intrinsic constant. Specifying the <I>adPersistADTG</I> intrinsic constant saves the recordset in the proprietary format.<P>
<PRE class="code">Sub&nbsp;SaveAccessDBRecordSource()<BR>On&nbsp;Error&nbsp;GoTo&nbsp;SaveAccessDB_Trap<BR>Dim&nbsp;cnn1&nbsp;As&nbsp;ADODB.Connection<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;varLocalAddress&nbsp;As&nbsp;Variant<P>
'Create&nbsp;the&nbsp;connection<BR>Set&nbsp;cnn1&nbsp;=&nbsp;New&nbsp;ADODB.Connection<BR>cnn1.Open&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=\\cabarmada\c\Program&nbsp;Files\Microsoft&nbsp;Office\&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Office10\Samples\Northwind.mdb;&quot;<P>
'Open&nbsp;recordset&nbsp;on&nbsp;Shippers&nbsp;table&nbsp;in&nbsp;the&nbsp;copy&nbsp;of&nbsp;<BR>'Northwind.mdb&nbsp;on&nbsp;a&nbsp;machine&nbsp;named&nbsp;cabarmada<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.Open&nbsp;&quot;Shippers&quot;,&nbsp;cnn1,&nbsp;adOpenKeyset,&nbsp;adLockOptimistic,&nbsp;adCmdTable<P>
'Specify&nbsp;a&nbsp;local&nbsp;address&nbsp;for&nbsp;the&nbsp;recordset&nbsp;based&nbsp;on&nbsp;Shippers&nbsp;table,<BR>'and&nbsp;save&nbsp;the&nbsp;recordset&nbsp;in&nbsp;XML&nbsp;format&nbsp;to&nbsp;that&nbsp;address<BR>varLocalAddress&nbsp;=&nbsp;&quot;C:\PMA&nbsp;Samples\Chapter&nbsp;02\ShippersFromCabarmada.xml&quot;<BR>rst1.Save&nbsp;varLocalAddress,&nbsp;adPersistXML<P>
SaveAccessDB_Exit:<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<BR>cnn1.Close<BR>Set&nbsp;cnn1&nbsp;=&nbsp;Nothing<BR>Exit&nbsp;Sub<P>
SaveAccessDB_Trap:<BR>If&nbsp;err.Number&nbsp;=&nbsp;58&nbsp;Then<BR>'Kill&nbsp;the&nbsp;temporary&nbsp;file&nbsp;of&nbsp;table&nbsp;data&nbsp;because&nbsp;it&nbsp;already&nbsp;exists,<BR>'and&nbsp;resume&nbsp;writing&nbsp;to&nbsp;the&nbsp;file<BR>&nbsp;&nbsp;&nbsp;&nbsp;Kill&nbsp;varLocalAddress<BR>&nbsp;&nbsp;&nbsp;&nbsp;Resume<BR>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox&nbsp;&quot;Procedure&nbsp;failed&nbsp;with&nbsp;an&nbsp;error&nbsp;number&nbsp;=&nbsp;&quot;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;err.Number&nbsp;&amp;&nbsp;&quot;,&nbsp;&quot;&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;&quot;and&nbsp;an&nbsp;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;error&nbsp;description&nbsp;of&nbsp;&quot;&quot;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err.Description&nbsp;&amp;&nbsp;&quot;&quot;&quot;&quot;&nbsp;&amp;&nbsp;&quot;.&quot;,&nbsp;vbInformation,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Programming&nbsp;Microsoft&nbsp;Access&nbsp;Version&nbsp;2002&quot;<BR>End&nbsp;If<P>
End&nbsp;Sub</PRE><P>
The sample's error trap is slightly more robust than necessary, but you will typically need an error trap with a procedure that saves a recordset to a file. This is because you will generate a run-time error if you attempt to save a recordset over an existing file. Since the number for this specific error is 58, the sample kills the old version of the file and resumes executing the line of code with the <I>Save</I> method.<P>
Figure 2-6 shows the saved file open in Internet Explorer. Notice that the XML tags show the schema information, such as data type and length for recordset fields, as well as the data for the file's contents.<P>
The <I>OpenSavedRecordset</I> sample that appears next illustrates the syntax for opening and browsing the contents of the file saved in the previous code sample. After declaring and instantiating a recordset, the procedure invokes the recordset's <I>Open </I>method. The source for the <I>Open </I>method is the path and filename for the recordset saved previously. In order to use the <I>Open </I>method this way, you must designate MSPersist as the provider for the connection argument. Notice that the <I>Options </I>argument is <I>adCmdFile</I>. I include this just to remind you of the general usefulness of specifying an <I>Options</I> argument. In this particular case, the argument is not necessary since ADO assumes an <I>adCmdFile</I> argument when you designate MSPersist as the provider.<P>
<A HREF="5241/0735614059-06.gif" target="_blank"><P><IMG SRC="/mspress/images/imagelink.gif" width=36 height=29 border=0 alt="Click to view graphic"></A><BR>Click to view graphic<P>
<B>Figure 2-6&nbsp;</B><I>The XML contents as seen from Internet Explorer for the file saved by the SaveAccessDBRecordSource procedure.</I><P>
After opening the file as a recordset, the code sample loops through the columns of each row as it prints the field name and value of each element in the recordset. With this simple code, you can open the local file and view its contents even when you are disconnected from the original version of the <I>Shippers</I> table on the cabarmada computer.<P>
<PRE class="code">Sub&nbsp;OpenSavedRecordset()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;int1&nbsp;As&nbsp;Integer<P>
'Instantiate&nbsp;recordset,&nbsp;and&nbsp;open&nbsp;from&nbsp;file&nbsp;with&nbsp;Persistence&nbsp;provider<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.Open&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;C:\PMA&nbsp;Samples\Chapter&nbsp;02\ShippersFromCabarmada.xml&quot;,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Provider=MSPersist;&quot;,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;,&nbsp;,&nbsp;adCmdFile<P>
'Loop&nbsp;through&nbsp;all&nbsp;rows;&nbsp;with&nbsp;each&nbsp;row&nbsp;loop&nbsp;through&nbsp;all&nbsp;columns<BR>Do&nbsp;Until&nbsp;rst1.EOF<BR>&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;int1&nbsp;=&nbsp;0&nbsp;To&nbsp;rst1.Fields.Count&nbsp;-&nbsp;1<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1.Fields(int1).Name,&nbsp;rst1(int1)<BR>&nbsp;&nbsp;&nbsp;&nbsp;Next&nbsp;int1<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Loop<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub</PRE><P>
As developers, we can use this technology to empower employees that must travel, enter data on a disconnected recordset, and then update the connected recorded source when they return to the office. By using the recordset's <I>UpdateBatch </I>method along with the ability to persist recordsets, you can readily meet this need. The <I>SaveEditInsertShippersAtNorthwindCS</I> procedure demonstrates the syntax that can help you empower &quot;road warrior&quot; employees. The sample creates a local recordset based on the <I>Shippers </I>table in the NorthwindCS database on the cab2000 SQL server. (Recall that the NorthwindCS database ships with Office XP.) Then the procedure saves this recordset to a local drive.<P>
<PRE class="code">Sub&nbsp;SaveEditInsertShippersAtNorthwindCS()<BR>On&nbsp;Error&nbsp;GoTo&nbsp;EditInsertCS_Trap<BR>Dim&nbsp;cnn1&nbsp;As&nbsp;ADODB.Connection<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;varLocalAddress&nbsp;As&nbsp;Variant<P>
'Local&nbsp;address&nbsp;for&nbsp;saved&nbsp;recordset<BR>varLocalAddress&nbsp;=&nbsp;&quot;c:\PMA&nbsp;Samples\Chapter&nbsp;02\ShippersFromCab2000.xml&quot;<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;a&nbsp;recordset<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.Open&nbsp;&quot;SELECT&nbsp;ShipperID,&nbsp;CompanyName,&nbsp;Phone&nbsp;FROM&nbsp;Shippers&quot;,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Provider=SQLOLEDB;Data&nbsp;Source=cab2000;User&nbsp;Id=sa;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Password=password;Initial&nbsp;Catalog=NorthwindCS;&quot;,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;adOpenDynamic,&nbsp;adLockOptimistic,&nbsp;adCmdText<P>
'Persist&nbsp;the&nbsp;recordset&nbsp;to&nbsp;disk&nbsp;as&nbsp;an&nbsp;XML&nbsp;file;&nbsp;this&nbsp;saves&nbsp;it&nbsp;<BR>'based&nbsp;on&nbsp;the&nbsp;Shippers&nbsp;table&nbsp;in&nbsp;the&nbsp;NorthwindCS&nbsp;database&nbsp;on&nbsp;the<BR>'cab2000&nbsp;server<BR>Kill&nbsp;varLocalAddress<BR>rst1.Save&nbsp;varLocalAddress,&nbsp;adPersistXML<P>
'Open&nbsp;the&nbsp;XML&nbsp;file&nbsp;locally<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.Open&nbsp;varLocalAddress,&nbsp;&quot;Provider=MSPersist;&quot;,&nbsp;,&nbsp;,&nbsp;adCmdFile<P>
'Find&nbsp;a&nbsp;record,&nbsp;and&nbsp;edit&nbsp;it&nbsp;in&nbsp;the&nbsp;local&nbsp;cache<BR>rst1.Find&nbsp;&quot;CompanyName&nbsp;=&nbsp;'Federal&nbsp;Shipping'&quot;<BR>If&nbsp;rst1.EOF&nbsp;Then<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;&quot;Name&nbsp;not&nbsp;found.&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Exit&nbsp;Sub<BR>End&nbsp;If<BR>rst1(&quot;CompanyName&quot;)&nbsp;=&nbsp;&quot;Federal&nbsp;Shippers&quot;<BR>rst1.Update<P>
'Add&nbsp;a&nbsp;record&nbsp;to&nbsp;the&nbsp;local&nbsp;cache<BR>rst1.AddNew<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;=&nbsp;&quot;CAB&nbsp;Movers&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Phone&quot;)&nbsp;=&nbsp;&quot;(555)&nbsp;234.5678&quot;<BR>rst1.Update<P>
'After&nbsp;committing&nbsp;the&nbsp;edit&nbsp;locally,&nbsp;connect&nbsp;to&nbsp;the&nbsp;remote<BR>'data&nbsp;source&nbsp;and&nbsp;update&nbsp;the&nbsp;remote&nbsp;source<BR>Set&nbsp;cnn1&nbsp;=&nbsp;New&nbsp;ADODB.Connection<BR>cnn1.Open&nbsp;&quot;Provider=SQLOLEDB;Data&nbsp;Source=cab2000;User&nbsp;Id=sa;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Password=password;Initial&nbsp;Catalog=NorthwindCS;&quot;<BR>rst1.ActiveConnection&nbsp;=&nbsp;cnn1<BR>rst1.UpdateBatch<P>
EditInsertCS_Exit:<BR>'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<BR>cnn1.Close<BR>Set&nbsp;cnn1&nbsp;=&nbsp;Nothing<BR>Exit&nbsp;Sub<P>
EditInsertCS_Trap:<BR>If&nbsp;err.Number&nbsp;=&nbsp;53&nbsp;Then<BR>'Tried&nbsp;to&nbsp;kill&nbsp;a&nbsp;file&nbsp;that&nbsp;doesn't&nbsp;exist,&nbsp;so&nbsp;simply&nbsp;resume<BR>&nbsp;&nbsp;&nbsp;&nbsp;Resume&nbsp;&nbsp;Next&nbsp;<BR>ElseIf&nbsp;err.Number&nbsp;=&nbsp;58&nbsp;Then<BR>'Kill&nbsp;the&nbsp;temporary&nbsp;file&nbsp;of&nbsp;table&nbsp;data&nbsp;if&nbsp;it&nbsp;already&nbsp;exists,<BR>'and&nbsp;resume&nbsp;writing&nbsp;to&nbsp;the&nbsp;file<BR>&nbsp;&nbsp;&nbsp;&nbsp;Kill&nbsp;varLocalAddress<BR>&nbsp;&nbsp;&nbsp;&nbsp;Resume<BR>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox&nbsp;&quot;Procedure&nbsp;failed&nbsp;with&nbsp;an&nbsp;error&nbsp;number&nbsp;=&nbsp;&quot;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;err.Number&nbsp;&amp;&nbsp;&quot;,&nbsp;&quot;&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;&quot;and&nbsp;an&nbsp;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;error&nbsp;description&nbsp;of&nbsp;&quot;&quot;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err.Description&nbsp;&amp;&nbsp;&quot;&quot;&quot;&quot;&nbsp;&amp;&nbsp;&quot;.&quot;,&nbsp;vbInformation,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Programming&nbsp;Microsoft&nbsp;Access&nbsp;Version&nbsp;2002&quot;<BR>End&nbsp;If<P>
End&nbsp;Sub</PRE><P>
A traveling employee can use this file-based version of a recordset to edit existing data and enter new data. The code sample simulates these tasks programmatically. The application of the <I>Update</I> method commits the changes to the recordset's local cache, but another <I>Save </I>method could transfer those updates from memory to the disk-based version of the local recordset.<P>
After returning from the field, employees will want to update the database at headquarters with their entries from the road. They can accomplish this goal by running a program you prepare that opens the file-based version of the recordset, connects the recordset to the server at headquarters, and invokes the <I>UpdateBatch </I>method for the local recordset. The <I>UpdateBatch</I> method, along with the recordset <I>Filter </I>property, enables developers to reconcile conflicts when they occur. See the Access Help files for more detailed coverage of conflict resolution issues. Database replication, another Access feature, offers more elaborate support for this capability, but some developers might care to build custom solutions using this technology.<P>
<Div class= "sidebar"><B>NOTE</B><HR><BR>
If you run the same procedure as <I>SaveEditInsertShippersAt-NorthwindCS</I>, except for updating its connections so that it initially opens and later updates the Access Northwind database file, it will fail. The precise error description is &quot;Cannot update 'ShipperID'; field not updateable.&quot; The solution to this problem for Access database files is to construct the initial file-based recordset without any primary keys that have an AutoNumber data type. Use an SQL statement as your source for the saved recordset to accomplish this. The companion CD includes a sample procedure, <I>SaveEditInsertShippersAtNorthwind</I>, with the detailed code to perform this task.</Div class= "sidebar"><P>
<H3><I><A NAME="130"></A>Sorting Recordsets</I></H3>
Many database applications benefit from a sorted recordset. Therefore, Microsoft added a <I>Sort </I>property to ADO recordsets. This is a very natural property for Access developers to use. Simply set the <I>Sort </I>property for a recordset to the list of field names on which you want the recordset sorted. Represent the field names as a comma-delimited string. The default sort order is ascending. However, you can explicitly set an ascending sort order for any field by trailing the field name with a blank followed by the <I>ASC</I> keyword. Replace the <I>ASC</I> keyword with <I>DESC</I> if you want a recordset sorted in descending order on the values within a field.<P>
In order for <I>Sort</I> property assignments to operate, you must assign the <I>adUseClient </I>intrinsic constant to the recordset's <I>CursorLocation </I>property. ADO takes advantage of user-defined indexes for tables when sorting recordsets. When no user-defined indexes exist, ADO constructs a temporary index to help speed the sorting of recordset rows on a field. You can clear any special sort (and delete temporary indexes that are automatically constructed) by assigning an empty string to the <I>Sort</I> property. You can also dynamically rearrange the order of rows within a recordset by designating a modified string of field names for the recordset's <I>Sort </I>property.<P>
The following code sample demonstrates how to set the <I>Sort </I>property, while revealing the syntax for most of its typical uses. The sample begins by creating a recordset based on the <I>Customers</I> table. Notice that the sample assigns the <I>adUseClient </I>intrinsic constant to the recordset's <I>CursorLocation</I> property. This is essential. (Without making the setting, the <I>Sort</I> property assignments fail at run time.)<P>
The procedure prints an excerpt of columns for the first five records in the currently sorted version of the recordset four different times. The first set of five records shows the default order, which is the order of the primary key or the order of entry for rows if no primary key exists. You don't need to set the <I>Sort </I>property to return records in this order (unless you are clearing a prior sort setting). The second set of five records sorts in ascending order on the <I>City</I> field values. To impose this order, the procedure merely assigns the string <I>&quot;City&quot; </I>to the <I>Sort</I> property. The next set of five records also sorts records on <I>City </I>field values, but in descending order. The <I>Sort</I> property setting for this order merely trails the field name by a space and the <I>DESC </I>keyword. The final sort order is by <I>City</I> field values within <I>Country </I>field values. Place the outer sort key, <I>Country</I>, first in the string for the <I>Sort</I> property so that the <I>City </I>field values appear in ascending order within each country.<P>
<PRE class="code">Sub&nbsp;SortCustomersDefaultCityUpDown()<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;int1&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int2&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int3&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int4&nbsp;As&nbsp;Integer<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;recordset&nbsp;based&nbsp;on&nbsp;customers;<BR>'set&nbsp;CursorLocation&nbsp;to&nbsp;adUseClient&nbsp;to&nbsp;support&nbsp;sorting<BR>Set&nbsp;rst1&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst1.CursorLocation&nbsp;=&nbsp;adUseClient<BR>rst1.Open&nbsp;&quot;Customers&quot;,&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<P>
'Find&nbsp;and&nbsp;save&nbsp;maximum&nbsp;length&nbsp;of&nbsp;CustomerID,&nbsp;CompanyName,<BR>'and&nbsp;ContactName&nbsp;fields<BR>int2&nbsp;=&nbsp;FindTheLongest(rst1,&nbsp;&quot;CustomerID&quot;)&nbsp;+&nbsp;1<BR>rst1.MoveFirst<BR>int3&nbsp;=&nbsp;FindTheLongest(rst1,&nbsp;&quot;CompanyName&quot;)&nbsp;+&nbsp;1<BR>rst1.MoveFirst<BR>int4&nbsp;=&nbsp;FindTheLongest(rst1,&nbsp;&quot;ContactName&quot;)&nbsp;+&nbsp;1<P>
'Print&nbsp;records&nbsp;in&nbsp;default&nbsp;order<BR>rst1.MoveFirst<BR>Debug.Print&nbsp;&quot;Default&nbsp;Order&quot;&nbsp;&amp;&nbsp;vbCr<BR>For&nbsp;int1&nbsp;=&nbsp;1&nbsp;To&nbsp;5<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;CustomerID&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst1(&quot;CustomerID&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int3&nbsp;-&nbsp;Len(rst1(&quot;CompanyName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;ContactName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int4&nbsp;-&nbsp;Len(rst1(&quot;ContactName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Phone&quot;),&nbsp;rst1(&quot;City&quot;),&nbsp;rst1(&quot;Country&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Next&nbsp;int1<P>
'Sort&nbsp;by&nbsp;City&nbsp;and&nbsp;print<BR>rst1.Sort&nbsp;=&nbsp;&quot;City&quot;<BR>rst1.MoveFirst<BR>Debug.Print&nbsp;String(2,&nbsp;vbCr)&nbsp;&amp;&nbsp;&quot;Order&nbsp;by&nbsp;City&nbsp;Ascending&quot;&nbsp;&amp;&nbsp;vbCr<BR>For&nbsp;int1&nbsp;=&nbsp;1&nbsp;To&nbsp;5<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;CustomerID&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst1(&quot;CustomerID&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int3&nbsp;-&nbsp;Len(rst1(&quot;CompanyName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;ContactName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int4&nbsp;-&nbsp;Len(rst1(&quot;ContactName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Phone&quot;),&nbsp;rst1(&quot;City&quot;),&nbsp;rst1(&quot;Country&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Next&nbsp;int1<P>
'Sort&nbsp;by&nbsp;descending&nbsp;City&nbsp;order&nbsp;and&nbsp;print<BR>rst1.Sort&nbsp;=&nbsp;&quot;City&nbsp;DESC&quot;<BR>rst1.MoveFirst<BR>Debug.Print&nbsp;String(2,&nbsp;vbCr)&nbsp;&amp;&nbsp;&quot;Order&nbsp;by&nbsp;City&nbsp;Descending&quot;&nbsp;&amp;&nbsp;vbCr<BR>For&nbsp;int1&nbsp;=&nbsp;1&nbsp;To&nbsp;5<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;CustomerID&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst1(&quot;CustomerID&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int3&nbsp;-&nbsp;Len(rst1(&quot;CompanyName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;ContactName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int4&nbsp;-&nbsp;Len(rst1(&quot;ContactName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Phone&quot;),&nbsp;rst1(&quot;City&quot;),&nbsp;rst1(&quot;Country&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Next&nbsp;int1<P>
'Sort&nbsp;by&nbsp;City&nbsp;within&nbsp;Country&nbsp;and&nbsp;print<BR>rst1.Sort&nbsp;=&nbsp;&quot;Country,&nbsp;City&quot;<BR>rst1.MoveFirst<BR>Debug.Print&nbsp;String(2,&nbsp;vbCr)&nbsp;&amp;&nbsp;_<BR>&quot;Order&nbsp;by&nbsp;Country&nbsp;Ascending,&nbsp;City&nbsp;Ascending&quot;&nbsp;&amp;&nbsp;vbCr<BR>For&nbsp;int1&nbsp;=&nbsp;1&nbsp;To&nbsp;5<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst1(&quot;CustomerID&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst1(&quot;CustomerID&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;CompanyName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int3&nbsp;-&nbsp;Len(rst1(&quot;CompanyName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;ContactName&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int4&nbsp;-&nbsp;Len(rst1(&quot;ContactName&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst1(&quot;Phone&quot;),&nbsp;rst1(&quot;City&quot;),&nbsp;rst1(&quot;Country&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst1.MoveNext<BR>Next&nbsp;int1<P>
'Clean&nbsp;up&nbsp;objects<BR>rst1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<P>
End&nbsp;Sub</PRE><P>
You can combine the <I>Sort</I> property for recordsets with other Access programming features to achieve useful results that are difficult to obtain programmatically any other way. For example, it is easy to list all the tables in an Access database file with any number of properties sorted however you need. The <I>OpenSchema</I> method for the <I>Connection</I> object returns recordsets with fields describing classes of objects within a database. This chapter demonstrated how to use this method earlier, but it did not show you how to customize the order of the output. This section demonstrates how to use the <I>Save </I>and <I>Open</I> methods in combination with the <I>Sort </I>property to arrange <I>OpenSchema</I> output to suit your needs.<P>
When used with a parameter set to <I>adSchemaTables</I>, the <I>OpenSchema</I> method outputs a recordset of table properties with information ordered by table name. However, this list mixes information about all types of tables in rows adjacent to one another. Therefore, it is difficult to find information about a particular user-defined table, view, or system table. Figure 2-7 shows the output to the Immediate window from a VBA program that sorts tables by table name, within table type. Along with the other two columns, this feature makes it easy to look up when a table was last modified or created.<P>
<A HREF="5241/0735614059-07.gif" target="_blank"><P><IMG SRC="/mspress/images/imagelink.gif" width=36 height=29 border=0 alt="Click to view graphic"></A><BR>Click to view graphic<P>
<B>Figure 2-7&nbsp;</B><I>Program output from the SortedTableTypes procedure, showing a list of tables sorted by table name within table type from the Northwind Access database file.</I><P>
The following pair of procedures generate the output shown in Figure 2-7. While this listing is long, you are already familiar with all the techniques that it integrates. The calling procedure, <I>CallSortedTableTypes</I>, designates a string that points at a database file and passes that string to the second procedure, <I>SortedTableTypes</I>. You can get a listing like the one in Figure 2-7 for any Access database file, just by changing the string.<P>
The second procedure generates a recordset about the tables in a database file by invoking the <I>OpenSchema </I>method with the <I>adSchemaTables</I> intrinsic constant as an argument. You cannot sort the output from the <I>OpenSchema</I> method because it sets the <I>CursorLocation </I>property to <I>adUseServer</I>. Therefore, the procedure saves the recordset and opens it again. This two-step process creates a version of the recordset with a <I>CursorLocation</I> property equal to <I>adUseClient</I>. In addition, the process yields a local version of the recordset for future use (for example, when you are disconnected from the computer with the database file). After changing the <I>CursorLocation </I>property setting, the procedure just needs to set the <I>Sort</I> property and print the results to the Immediate window. By specifying TABLE_TYPE before TABLE_NAME, the procedure forces the output to show table names sorted alphabetically within the table type.<P>
<PRE class="code">Sub&nbsp;CallSortedTableTypes()<BR>Dim&nbsp;str1&nbsp;As&nbsp;String<P>
'Specify&nbsp;database&nbsp;for&nbsp;which&nbsp;to&nbsp;generate&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;tables<BR>str1&nbsp;=&nbsp;&quot;Provider=Microsoft.Jet.OLEDB.4.0;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Data&nbsp;Source=C:\PMA&nbsp;Samples\Northwind.mdb;&quot;<P>
'Call&nbsp;sub&nbsp;procedure&nbsp;to&nbsp;create&nbsp;sorted&nbsp;list&nbsp;of&nbsp;tables<BR>SortedTableTypes&nbsp;str1<P>
End&nbsp;Sub<P>
Sub&nbsp;SortedTableTypes(str1&nbsp;As&nbsp;String)<BR>On&nbsp;Error&nbsp;GoTo&nbsp;SortedTableTypes_Trap<BR>Dim&nbsp;cnn1&nbsp;As&nbsp;ADODB.Connection<BR>Dim&nbsp;rst1&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;rst2&nbsp;As&nbsp;ADODB.Recordset<BR>Dim&nbsp;int1&nbsp;As&nbsp;Integer<BR>Dim&nbsp;int2&nbsp;As&nbsp;Integer<P>
'Instantiate&nbsp;and&nbsp;open&nbsp;connection<BR>Set&nbsp;cnn1&nbsp;=&nbsp;New&nbsp;ADODB.Connection<BR>cnn1.Open&nbsp;str1<P><br>
'Save&nbsp;tables&nbsp;report&nbsp;in&nbsp;rst1<BR>Set&nbsp;rst1&nbsp;=&nbsp;cnn1.OpenSchema(adSchemaTables)<P>
'Since&nbsp;OpenSchema&nbsp;returns&nbsp;a&nbsp;server-based&nbsp;cursor,&nbsp;save&nbsp;original<BR>'returned&nbsp;recordset&nbsp;and&nbsp;reopen&nbsp;saved&nbsp;data&nbsp;with&nbsp;a&nbsp;new&nbsp;recordset;<BR>'the&nbsp;new&nbsp;recordset&nbsp;has&nbsp;a&nbsp;local&nbsp;cursor&nbsp;that&nbsp;you&nbsp;can&nbsp;sort<BR>rst1.Save&nbsp;&quot;C:\PMA&nbsp;Samples\Chapter&nbsp;02\foo.adtg&quot;,&nbsp;adPersistADTG<BR>Set&nbsp;rst2&nbsp;=&nbsp;New&nbsp;ADODB.Recordset<BR>rst2.Open&nbsp;&quot;C:\PMA&nbsp;Samples\Chapter&nbsp;02\foo.adtg&quot;,&nbsp;&quot;Provider=MSPersist&quot;<P>
'Sort&nbsp;copied&nbsp;data&nbsp;by&nbsp;table&nbsp;name&nbsp;within&nbsp;table&nbsp;type<BR>rst2.Sort&nbsp;=&nbsp;&quot;TABLE_TYPE,&nbsp;TABLE_NAME&quot;<P>
'Compute&nbsp;maximum&nbsp;length&nbsp;of&nbsp;TABLE_NAME&nbsp;and&nbsp;TABLE_TYPE&nbsp;columns<BR>int1&nbsp;=&nbsp;FindTheLongest(rst2,&nbsp;&quot;TABLE_NAME&quot;)&nbsp;+&nbsp;1<BR>rst2.MoveFirst<BR>int2&nbsp;=&nbsp;FindTheLongest(rst2,&nbsp;&quot;TABLE_TYPE&quot;)&nbsp;+&nbsp;1<BR>rst2.MoveFirst<P>
'Loop&nbsp;through&nbsp;sorted&nbsp;results&nbsp;set&nbsp;from&nbsp;OPENSCHEMA&nbsp;query,<BR>'and&nbsp;print&nbsp;selected&nbsp;columns<BR>Do&nbsp;Until&nbsp;rst2.EOF<BR>&nbsp;&nbsp;&nbsp;&nbsp;Debug.Print&nbsp;rst2.Fields(&quot;TABLE_NAME&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int1&nbsp;-&nbsp;Len(rst2(&quot;TABLE_NAME&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst2.Fields(&quot;TABLE_TYPE&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String(int2&nbsp;-&nbsp;Len(rst2(&quot;TABLE_TYPE&quot;)),&nbsp;&quot;&nbsp;&quot;)&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst2.Fields(&quot;DATE_MODIFIED&quot;),&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rst2.Fields(&quot;DATE_CREATED&quot;)<BR>&nbsp;&nbsp;&nbsp;&nbsp;rst2.MoveNext<BR>Loop<P>
SortedTableTypes_Exit:<BR>rst1.Close<BR>rst2.Close<BR>cnn1.Close<BR>Set&nbsp;rst1&nbsp;=&nbsp;Nothing<BR>Set&nbsp;rst2&nbsp;=&nbsp;Nothing<BR>Set&nbsp;cnn1&nbsp;=&nbsp;Nothing<BR>Exit&nbsp;Sub<P>
SortedTableTypes_Trap:<BR>If&nbsp;err.Number&nbsp;=&nbsp;58&nbsp;Then<BR>'Kill&nbsp;the&nbsp;temporary&nbsp;file&nbsp;of&nbsp;table&nbsp;data&nbsp;if&nbsp;it&nbsp;already&nbsp;exists,<BR>'and&nbsp;resume&nbsp;writing&nbsp;to&nbsp;the&nbsp;file<BR>&nbsp;&nbsp;&nbsp;&nbsp;Kill&nbsp;&quot;C:\PMA&nbsp;Samples\Chapter&nbsp;02\foo.adtg&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Resume<BR>Else<BR>&nbsp;&nbsp;&nbsp;&nbsp;MsgBox&nbsp;&quot;Procedure&nbsp;failed&nbsp;with&nbsp;an&nbsp;error&nbsp;number&nbsp;=&nbsp;&quot;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&nbsp;err.Number&nbsp;&amp;&nbsp;&quot;,&nbsp;&quot;&nbsp;&amp;&nbsp;vbCrLf&nbsp;&amp;&nbsp;&quot;and&nbsp;an&nbsp;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;error&nbsp;description&nbsp;of&nbsp;&quot;&quot;&quot;&nbsp;&amp;&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;err.Description&nbsp;&amp;&nbsp;&quot;&quot;&quot;&quot;&nbsp;&amp;&nbsp;&quot;.&quot;,&nbsp;vbInformation,&nbsp;_<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;Programming&nbsp;Microsoft&nbsp;Access&nbsp;Version&nbsp;2002&quot;<BR>&nbsp;&nbsp;&nbsp;&nbsp;Resume&nbsp;SortedTableTypes_Exit<BR>End&nbsp;If<P>
End&nbsp;Sub</PRE><P>

<P><HR><P>
<CENTER>  
<A HREF="5241c.aspx">Previous</A>
&nbsp;&nbsp;|&nbsp;&nbsp;<A HREF="5241.aspx">Table of Contents</A>
&nbsp;&nbsp;|&nbsp;&nbsp;
<A HREF="5241e.aspx">Next</A>
</CENTER>

<P><hr><p> 
<!--End Body Area-->

<BR>
<font size="1">Last Updated: August 10, 2001</font>

<!--StartBottomInc-->
<br />
<table border="0" cellspacing="0" cellpadding="0" width="100%">
<tr><td valign="middle" align="left" width="100%"><font face="verdana,arial,helvetica" size="1"><a class="bookmark" href="#top"><b>Top of Page</b></a></font></td></tr>
</table>
<!--EndBottomInc-->

<BR>
    </td></tr>
  </table>
</td></tr>
<tr><td>
  <script language="javascript">renderFooter();</script>
  <noscript>
    <img src="/library/toolbar/3.0/noscript.aspx?type=logo" alt="Microsoft" title="" align="right" />
    息2006 Microsoft Corporation. All rights reserved.
    <a href="http://www.microsoft.com/info/cpyright.htm">Terms of Use</a> |
    <a href="http://www.microsoft.com/info/privacy.htm">Privacy Statement</a>
  </noscript>

</Body>
</HTML>



